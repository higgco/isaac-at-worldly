SELECT
    CUBE.assessment_id AS assessment_id,
    CUBE.status AS status,
    CUBE.rfi_pid AS rfi_pid,
	CASE WHEN (((CUBE.facility_posted = TRUE) OR (CUBE.verifier_posted = TRUE)) AND CUBE.status != 'ASD')
		THEN TRUE ELSE FALSE END AS ih_eligible,
    CUBE.performance->>'wattrackdomprodsep' AS wattrackdomprodsep,
    (CUBE.performance->>'production_water_use')::numeric AS production_water_use,
    (CUBE.performance->>'domestic_total_water_l')::numeric AS domestic_total_water_l,
    (CUBE.performance->>'watsourcetotaltotal')::numeric AS watsourcetotaltotal,

    (CUBE.performance ->> 'finalProductAssembly_water_l')::numeric AS finalProductAssembly_water_l,
    (CUBE.performance ->> 'printingProductDyeingAndLaundering_water_l')::numeric AS printingProductDyeingAndLaundering_water_l,
    (CUBE.performance ->> 'hardComponentTrimProduction_water_l')::numeric AS hardComponentTrimProduction_water_l,
    (CUBE.performance ->> 'materialProduction_water_l')::numeric AS materialProduction_water_l,
    (CUBE.performance ->> 'rawMaterialProcessing_water_l')::numeric AS rawMaterialProcessing_water_l,
    (CUBE.performance ->> 'rawMaterialCollection_water_l')::numeric AS rawMaterialCollection_water_l,
    (CUBE.performance ->> 'finalProductAssemblytotal')::numeric AS finalProductAssemblytotal,
    (CUBE.performance ->> 'printingProductDyeingAndLaunderingtotal')::numeric AS printingProductDyeingAndLaunderingtotal,
    (CUBE.performance ->> 'hardComponentTrimProductiontotal')::numeric AS hardComponentTrimProductiontotal,
    (CUBE.performance ->> 'materialProductiontotal')::numeric AS materialProductiontotal,
    (CUBE.performance ->> 'rawMaterialProcessingtotal')::numeric AS rawMaterialProcessingtotal,
    (CUBE.performance ->> 'rawMaterialCollectiontotal')::numeric AS rawMaterialCollectiontotal,
    (CUBE.performance ->> 'water_intensity_l_pc')::numeric AS water_intensity_l_pc,
    (CUBE.performance ->> 'water_intensity_l_kg')::numeric AS water_intensity_l_kg,

    CUBE.performance ->> 'watproduse' AS watproduse

FROM fem_simple CUBE
WHERE (((CUBE.facility_posted = TRUE) OR (CUBE.verifier_posted = TRUE)) AND CUBE.status != 'ASD')
